<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link href="./_app/immutable/assets/0.DCujTuwm.css" rel="stylesheet">
		<link rel="modulepreload" href="./_app/immutable/entry/start.BHSPxaum.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/CSCBRq_J.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/CKch0Ex6.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/B3fq_xQP.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/BbM6ZZ-U.js">
		<link rel="modulepreload" href="./_app/immutable/entry/app.CELaE7bq.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/U2BH8B_v.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/BYaZGKia.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/7CVtkmix.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/CnK2asa7.js">
		<link rel="modulepreload" href="./_app/immutable/nodes/0.Cfr_KHjd.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/BH7NJh3d.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/Pu9JFYFi.js">
		<link rel="modulepreload" href="./_app/immutable/chunks/gCE6WlaA.js">
		<link rel="modulepreload" href="./_app/immutable/nodes/3.ppFR6Wgb.js"><!--12qhfyh--><link rel="icon" href="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='107'%20height='128'%20viewBox='0%200%20107%20128'%3e%3ctitle%3esvelte-logo%3c/title%3e%3cpath%20d='M94.157%2022.819c-10.4-14.885-30.94-19.297-45.792-9.835L22.282%2029.608A29.92%2029.92%200%200%200%208.764%2049.65a31.5%2031.5%200%200%200%203.108%2020.231%2030%2030%200%200%200-4.477%2011.183%2031.9%2031.9%200%200%200%205.448%2024.116c10.402%2014.887%2030.942%2019.297%2045.791%209.835l26.083-16.624A29.92%2029.92%200%200%200%2098.235%2078.35a31.53%2031.53%200%200%200-3.105-20.232%2030%2030%200%200%200%204.474-11.182%2031.88%2031.88%200%200%200-5.447-24.116'%20style='fill:%23ff3e00'/%3e%3cpath%20d='M45.817%20106.582a20.72%2020.72%200%200%201-22.237-8.243%2019.17%2019.17%200%200%201-3.277-14.503%2018%2018%200%200%201%20.624-2.435l.49-1.498%201.337.981a33.6%2033.6%200%200%200%2010.203%205.098l.97.294-.09.968a5.85%205.85%200%200%200%201.052%203.878%206.24%206.24%200%200%200%206.695%202.485%205.8%205.8%200%200%200%201.603-.704L69.27%2076.28a5.43%205.43%200%200%200%202.45-3.631%205.8%205.8%200%200%200-.987-4.371%206.24%206.24%200%200%200-6.698-2.487%205.7%205.7%200%200%200-1.6.704l-9.953%206.345a19%2019%200%200%201-5.296%202.326%2020.72%2020.72%200%200%201-22.237-8.243%2019.17%2019.17%200%200%201-3.277-14.502%2017.99%2017.99%200%200%201%208.13-12.052l26.081-16.623a19%2019%200%200%201%205.3-2.329%2020.72%2020.72%200%200%201%2022.237%208.243%2019.17%2019.17%200%200%201%203.277%2014.503%2018%2018%200%200%201-.624%202.435l-.49%201.498-1.337-.98a33.6%2033.6%200%200%200-10.203-5.1l-.97-.294.09-.968a5.86%205.86%200%200%200-1.052-3.878%206.24%206.24%200%200%200-6.696-2.485%205.8%205.8%200%200%200-1.602.704L37.73%2051.72a5.42%205.42%200%200%200-2.449%203.63%205.79%205.79%200%200%200%20.986%204.372%206.24%206.24%200%200%200%206.698%202.486%205.8%205.8%200%200%200%201.602-.704l9.952-6.342a19%2019%200%200%201%205.295-2.328%2020.72%2020.72%200%200%201%2022.237%208.242%2019.17%2019.17%200%200%201%203.277%2014.503%2018%2018%200%200%201-8.13%2012.053l-26.081%2016.622a19%2019%200%200%201-5.3%202.328'%20style='fill:%23fff'/%3e%3c/svg%3e"/> <link rel="stylesheet" href="./shadcn.css"/> <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/><!---->
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents"><!--[--><!--[--><!----><header style="background:var(--color-card); color:var(--color-card-foreground); padding:1rem; display:grid; grid-template-columns: 1fr auto 1fr; align-items:center; gap:1rem;"><div></div> <div style="display:flex; align-items:center; justify-content:center;"><!----><h1 tabindex="0" role="link" style="--rt-speed: 50s; --rt-close: 300%" class="rainbow-title  svelte-uqybtb"><!--[--><!---->Text to ICS Converter<!--]--><!----></h1><!----><!----></div> <div style="display:flex; justify-content:flex-end;"><button style="padding:.35rem .5rem; border-radius:6px; background:var(--color-primary); color:var(--color-primary-foreground); border:none; cursor:pointer; display:flex; align-items:center; gap:.5rem;" aria-label="Toggle theme"><span class="material-icons" aria-hidden="true">dark_mode</span></button></div></header> <main style="padding:1.25rem; background:var(--color-background); color:var(--color-foreground); min-height:calc(100vh - 72px);"><!----><section style="max-width:1100px; margin:0 auto; font-family:var(--font-sans);"><h2 style="margin-top:0;">Review Your Appointments</h2> <div style="display:flex; gap:1rem; align-items:center; margin-bottom:1rem;"><div><label for="sort">Sort:</label> <select id="sort" style="padding:.35rem; border-radius:6px;"><option value="asc">Date Ascending</option><option value="desc">Date Descending</option></select></div> <div style="margin-left:auto;"><button id="download-top" style="padding:.5rem .75rem; border-radius:6px; background:var(--color-primary); color:var(--color-primary-foreground); border:none; cursor:pointer; display:flex; gap:.5rem; align-items:center;" aria-label="Download ICS"><span class="material-icons" aria-hidden="true">download</span>Download ICS File</button></div></div> <div id="no-data" style="color:var(--color-muted-foreground); display:none;">No appointments found. Go back to the <a href="./">landing page</a> to add some.</div> <div style="overflow:auto;"><table style="width:100%; border-collapse:collapse;"><thead style="text-align:left; border-bottom:1px solid var(--color-border);"><tr><th style="padding:.5rem">Date</th><th style="padding:.5rem">Start Time</th><th style="padding:.5rem">End Time</th><th style="padding:.5rem">Preview</th></tr></thead><tbody id="appointments-tbody"></tbody></table></div> <div style="margin-top:1rem;"><button id="download-bottom" style="padding:.5rem .75rem; border-radius:6px; background:var(--color-primary); color:var(--color-primary-foreground); border:none; cursor:pointer; display:flex; gap:.5rem; align-items:center;" aria-label="Download ICS"><span class="material-icons" aria-hidden="true">download</span>Download ICS File</button></div> <script>
    document.addEventListener('DOMContentLoaded', function () {
      const sortSelect = document.getElementById('sort');
      const tbody = document.getElementById('appointments-tbody');
      const noDataDiv = document.getElementById('no-data');
      const downloadTop = document.getElementById('download-top');
      const downloadBottom = document.getElementById('download-bottom');

      let appointments = [];
      let eventTitle = 'Appointment';

      function loadAppointments() {
        const raw = localStorage.getItem('appointments');
        if (!raw) return [];
        try {
          return JSON.parse(raw);
        } catch (e) {
          return [];
        }
      }

      function render() {
        tbody.innerHTML = '';
        if (!appointments.length) {
          noDataDiv.style.display = 'block';
          downloadTop.disabled = downloadBottom.disabled = true;
          return;
        }
        noDataDiv.style.display = 'none';
        downloadTop.disabled = downloadBottom.disabled = false;
        for (let i = 0; i < appointments.length; i++) {
          const a = appointments[i];
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td style="padding:.5rem">${a.date}</td>
            <td style="padding:.5rem">${a.startTime}</td>
            <td style="padding:.5rem">${a.endTime}</td>
            <td style="padding:.5rem">${formatPreview(a)}</td>
          `;
          tbody.appendChild(tr);
        }
      }

      function formatPreview(a) {
        // produce: "Appointment on January 10, 2026 from 09:00 to 10:30"
        const [y, m, d] = a.date.split('-').map(Number);
        const dt = new Date(y, m - 1, d);
        const dateStr = dt.toLocaleDateString(undefined, { year: 'numeric', month: 'long', day: 'numeric' });
        return `${eventTitle} on ${dateStr} from ${a.startTime} to ${a.endTime}`;
      }

      function sortAppointments(order = 'asc') {
        appointments.sort((a, b) => {
          const t1 = dateTimeKey(a);
          const t2 = dateTimeKey(b);
          return order === 'asc' ? t1 - t2 : t2 - t1;
        });
      }

      function dateTimeKey(a) {
        // produce a comparable number from date and startTime
        const [y, m, d] = a.date.split('-').map(Number);
        const [hh, mm] = a.startTime.split(':').map(Number);
        return Date.UTC(y, m - 1, d, hh, mm, 0);
      }

      function generateICS(arr) {
        const lines = ['BEGIN:VCALENDAR', 'VERSION:2.0', 'PRODID:-//text-to-ics//EN'];
        for (let i = 0; i < arr.length; i++) {
          const a = arr[i];
          const uid = `${Date.now()}-${i}@txt-to-ics`;
          const [y, m, d] = a.date.split('-').map(Number);
          const [sh, sm] = a.startTime.split(':').map(Number);
          const [eh, em] = a.endTime.split(':').map(Number);
          const dtStart = new Date(Date.UTC(y, m - 1, d, sh, sm, 0));
          const dtEnd = new Date(Date.UTC(y, m - 1, d, eh, em, 0));
          lines.push('BEGIN:VEVENT');
          lines.push(`UID:${uid}`);
          lines.push(`SUMMARY:${eventTitle}`);
          lines.push(`DTSTAMP:${formatICSDate(new Date())}`);
          lines.push(`DTSTART:${formatICSDate(dtStart)}`);
          lines.push(`DTEND:${formatICSDate(dtEnd)}`);
          lines.push('END:VEVENT');
        }
        lines.push('END:VCALENDAR');
        return lines.join('\r\n');
      }

      function formatICSDate(d) {
        const pad = (n) => String(n).padStart(2, '0');
        return d.getUTCFullYear()
          + pad(d.getUTCMonth() + 1)
          + pad(d.getUTCDate())
          + 'T'
          + pad(d.getUTCHours())
          + pad(d.getUTCMinutes())
          + pad(d.getUTCSeconds())
          + 'Z';
      }

      function downloadICS() {
        if (!appointments.length) return alert('No appointments to download.');
        const ics = generateICS(appointments);
        const blob = new Blob([ics], { type: 'text/calendar;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'appointments.ics';
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(url);
      }

      // init
      appointments = loadAppointments();
      eventTitle = localStorage.getItem('eventTitle') || 'Appointment';
      sortAppointments('asc');
      render();

      sortSelect.addEventListener('change', () => {
        sortAppointments(sortSelect.value);
        render();
      });

      downloadTop.addEventListener('click', downloadICS);
      downloadBottom.addEventListener('click', downloadICS);
    });
  </script></section><!----><!----></main><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_e7ls8k = {
						base: new URL(".", location).pathname.slice(0, -1),
						assets: "/txt-to-ics-converter"
					};

					const element = document.currentScript.parentElement;

					Promise.all([
						import("./_app/immutable/entry/start.BHSPxaum.js"),
						import("./_app/immutable/entry/app.CELaE7bq.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 3],
							data: [null,null],
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
